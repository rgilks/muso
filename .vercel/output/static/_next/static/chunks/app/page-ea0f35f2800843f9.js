(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6221:(e,t,n)=>{Promise.resolve().then(n.bind(n,8577))},8577:(e,t,n)=>{"use strict";n.d(t,{default:()=>a});var r=n(5155),l=n(2115);function a(){let e=(0,l.useRef)(null),[t,n]=(0,l.useState)(!1),[a,u]=(0,l.useState)(100),[i,c]=(0,l.useState)(0),[s,o]=(0,l.useState)(0),m=(0,l.useRef)(null),d=(0,l.useRef)(null),f=(0,l.useRef)(null),p=(0,l.useRef)(null),h=(0,l.useRef)(null),g=(0,l.useRef)(null),x=(0,l.useRef)(null),v=(0,l.useRef)(null),w=(0,l.useRef)(null),b=(0,l.useRef)(null),M=(0,l.useRef)(null),y=(0,l.useRef)(null),_=(0,l.useRef)(null),R=(0,l.useRef)(null);async function N(){if(t)return;let r=new AudioContext({sampleRate:48e3});g.current=r;let l=new URL("/dsp/dsp.js",window.location.origin).toString();_.current=await import(l),await _.current.default("/dsp/dsp_bg.wasm"),_.current.init_engine(r.sampleRate),await r.audioWorklet.addModule("/worklet/processor.js");let s=new AudioWorkletNode(r,"rust-dsp",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[2]});v.current=s,s.port.postMessage({type:"config",sampleRate:r.sampleRate}),s.port.onmessage=e=>{var t,n;if((null==(t=e.data)?void 0:t.type)==="pull"){let t=new Float32Array(2*e.data.frames);null==(n=_.current)||n.render_into(t),s.port.postMessage({type:"block",buf:t},[t.buffer])}};let N=r.createAnalyser();N.fftSize=2048,x.current=N,s.connect(N);let j=r.createBiquadFilter();j.type="lowpass";let F=p.current?parseFloat(p.current.value):6e3,C=h.current?parseFloat(h.current.value):.7;j.frequency.value=isFinite(F)?F:6e3,j.Q.value=isFinite(C)?C:.7,b.current=j;let A=r.createGain();w.current=A;let k=f.current?parseFloat(f.current.value):.8;A.gain.value=isFinite(k)?k:.8,N.connect(j),j.connect(A),A.connect(r.destination);let E=()=>_.current.set_reverb(parseFloat(m.current.value),parseFloat(d.current.value));E();let S=m.current,T=d.current,L=f.current,q=p.current,O=h.current;S.addEventListener("input",E),T.addEventListener("input",E);let z=()=>{if(w.current&&f.current){let e=parseFloat(f.current.value);w.current.gain.value=isFinite(e)?e:w.current.gain.value}},V=()=>{if(b.current&&p.current&&g.current){let e=parseFloat(p.current.value);b.current.frequency.setTargetAtTime(Math.max(20,Math.min(2e4,isFinite(e)?e:b.current.frequency.value)),g.current.currentTime,.01)}},B=()=>{if(b.current&&h.current&&g.current){let e=parseFloat(h.current.value);b.current.Q.setTargetAtTime(Math.max(1e-4,isFinite(e)?e:b.current.Q.value),g.current.currentTime,.01)}};L.addEventListener("input",z),q.addEventListener("input",V),O.addEventListener("input",B),y.current=()=>{S.removeEventListener("input",E),T.removeEventListener("input",E),L.removeEventListener("input",z),q.removeEventListener("input",V),O.removeEventListener("input",B)};let I=e.current,P=I.getContext("2d"),Q=()=>{let e=Math.max(1,Math.min(3,window.devicePixelRatio||1)),t=Math.max(300,Math.round(I.getBoundingClientRect().width)),n=Math.max(160,Math.min(480,Math.round(.28*t)));I.style.height="".concat(n,"px"),I.width=Math.floor(t*e),I.height=Math.floor(n*e),P.setTransform(1,0,0,1,0,0),P.scale(e,e)};Q(),window.addEventListener("resize",()=>Q());let D=document.createElement("canvas");D.width=256,D.height=256;let G=D.getContext("2d"),W=G.createImageData(D.width,D.height);for(let e=0;e<W.data.length;e+=4){let t=255*Math.random()|0;W.data[e+0]=0,W.data[e+1]=t,W.data[e+2]=0,W.data[e+3]=t>200?20:12}G.putImageData(W,0,0),R.current=D;let U=()=>{let e=x.current;if(!e)return;let t=new Uint8Array(e.frequencyBinCount),n=Math.max(1,Math.min(3,window.devicePixelRatio||1)),r=I.width/n,l=I.height/n;e.getByteFrequencyData(t),P.fillStyle="#070a12",P.fillRect(0,0,r,l);let a=P.createRadialGradient(.5*r,.5*l,.1*Math.min(r,l),.5*r,.5*l,.7*Math.max(r,l));a.addColorStop(0,"rgba(0,255,120,0.02)"),a.addColorStop(1,"rgba(0,0,0,0.35)"),P.fillStyle=a,P.fillRect(0,0,r,l);let u=r/128,i=P.createLinearGradient(0,l,0,0);i.addColorStop(0,"#093"),i.addColorStop(1,"#0f8"),P.fillStyle=i;for(let e=0;e<128;e++){let n=Math.floor(e*t.length/128),r=Math.floor((e+1)*t.length/128),a=0;for(let e=n;e<r;e++)a+=t[e];let i=Math.max(0,Math.min(l,a/Math.max(1,r-n)/255*(1+(Math.random()-.5)*.06)*l)),c=(Math.random()-.5)*.8;P.fillRect(e*u+c,l-i,Math.max(1,u-1),i)}P.globalAlpha=.1,P.fillStyle="#00ff88";for(let e=0;e<l;e+=2)P.fillRect(0,e,r,1);if(P.globalAlpha=1,.08>Math.random()){let e=1+Math.floor(3*Math.random());for(let t=0;t<e;t++){let e=Math.random()*l,t=4+20*Math.random(),n=(Math.random()-.5)*12;P.globalCompositeOperation="lighter",P.drawImage(I,0,e,r,t,n,e,r,t),P.globalCompositeOperation="source-over"}}if(R.current){P.globalAlpha=.08+.05*Math.random();let e=Math.random()*(R.current.width-1),t=Math.random()*(R.current.height-1);P.drawImage(R.current,e,t,R.current.width-e,R.current.height-t,0,0,r,l),P.globalAlpha=1}try{var c,s;let e=null==(s=_.current)||null==(c=s.get_current_step)?void 0:c.call(s);"number"==typeof e&&o(e)}catch(e){}M.current=requestAnimationFrame(U)};M.current=requestAnimationFrame(U),await r.resume();try{var H,J,K,X,Y,Z;let e=null!=(Y=null==(J=_.current)||null==(H=J.get_bpm)?void 0:H.call(J))?Y:a,t=null!=(Z=null==(X=_.current)||null==(K=X.get_sequence_mask)?void 0:K.call(X))?Z:i;u(e),c(t)}catch(e){}n(!0)}return(0,l.useEffect)(()=>()=>{var e,t,n,r;null!=M.current&&cancelAnimationFrame(M.current),null==(e=y.current)||e.call(y);try{null==(n=v.current)||n.disconnect(),null==(r=x.current)||r.disconnect()}catch(e){}null==(t=g.current)||t.close().catch(()=>{}),v.current=null,x.current=null,g.current=null},[]),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"neon-panel grid gap-3 sm:gap-4 sm:grid-cols-12",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:col-span-3",children:[(0,r.jsx)("button",{className:"border border-cyan-400/60 bg-[#0a0f1f]/80 text-cyan-100 py-2 px-5 rounded-lg shadow-[0_0_12px_#00eaff66] hover:bg-[#0f1a2f]/80 hover:shadow-[0_0_18px_#00eaffaa] transition w-full",onClick:()=>t?function(){var e,r,l,a,u,i;if(t||g.current){null!=M.current&&(cancelAnimationFrame(M.current),M.current=null),window.removeEventListener("resize",()=>{}),null==(e=y.current)||e.call(y),y.current=null;try{null==(l=v.current)||l.disconnect(),null==(a=x.current)||a.disconnect(),null==(u=b.current)||u.disconnect(),null==(i=w.current)||i.disconnect()}catch(e){}null==(r=g.current)||r.close().catch(()=>{}),v.current=null,x.current=null,b.current=null,w.current=null,g.current=null,n(!1)}}():N(),children:t?"Stop":"Start"}),(0,r.jsx)("button",{className:"relative w-full rounded-lg py-2 px-5 text-black font-semibold bg-gradient-to-r from-fuchsia-400 via-cyan-300 to-lime-300 hover:from-fuchsia-300 hover:via-cyan-200 hover:to-lime-200 shadow-[0_0_14px_#ff00ff66,0_0_24px_#00eaff55] border border-white/20 transition animate-pulse",onClick:function(){var e,t,n,r,l,s,o,m;null==(t=_.current)||null==(e=t.randomize)||e.call(t);try{let e=null!=(o=null==(r=_.current)||null==(n=r.get_bpm)?void 0:n.call(r))?o:a,t=null!=(m=null==(s=_.current)||null==(l=s.get_sequence_mask)?void 0:l.call(s))?m:i;u(e),c(t)}catch(e){}let d=g.current;if(d){if(b.current){let e=Math.exp(Math.log(150)+Math.random()*(Math.log(14e3)-Math.log(150))),t=18*Math.random();b.current.frequency.setTargetAtTime(e,d.currentTime,.03),b.current.Q.setTargetAtTime(Math.max(1e-4,t),d.currentTime,.03)}if(w.current){let e=.18+.5*Math.random();w.current.gain.setTargetAtTime(e,d.currentTime,.03)}}},title:"Randomize the sound",children:"Randomize"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 sm:col-span-9",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 text-cyan-200 w-full sm:w-auto",children:["BPM",(0,r.jsx)("input",{type:"range",min:"40",max:"200",step:"1",value:a,onChange:e=>{var t,n;let r=parseFloat(e.target.value);u(r),null==(n=_.current)||null==(t=n.set_bpm)||t.call(n,r)},className:"slider-neon w-full sm:w-[200px]"}),(0,r.jsx)("span",{className:"ml-1 tabular-nums w-10 text-center",children:Math.round(a)})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-cyan-200 w-full sm:w-auto",children:["Mix"," ",(0,r.jsx)("input",{ref:m,type:"range",min:"0",max:"1",step:"0.01",defaultValue:"0.55",className:"slider-neon w-full sm:w-[200px]"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-lime-200 w-full sm:w-auto",children:["LPF",(0,r.jsx)("input",{ref:p,type:"range",min:"20",max:"20000",step:"1",defaultValue:"6000",className:"slider-neon accent-lime-400 w-full sm:w-[220px]"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-lime-200 w-full sm:w-auto",children:["Res",(0,r.jsx)("input",{ref:h,type:"range",min:"0",max:"24",step:"0.01",defaultValue:"0.7",className:"slider-neon accent-lime-500 w-full sm:w-[200px]"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-cyan-200 w-full sm:w-auto",children:["Width"," ",(0,r.jsx)("input",{ref:d,type:"range",min:"0",max:"1",step:"0.01",defaultValue:"0.9",className:"slider-neon w-full sm:w-[200px]"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-pink-200 w-full sm:w-auto",children:["Volume",(0,r.jsx)("input",{ref:f,type:"range",min:"0",max:"1",step:"0.01",defaultValue:"0.3",className:"slider-neon accent-pink-500 w-full sm:w-[200px]"})]})]})]}),(0,r.jsx)("div",{className:"neon-panel p-3 sm:p-4",children:(0,r.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(16, minmax(0, 1fr))"},children:Array.from({length:16}).map((e,t)=>{let n=(i>>t&1)==1;return(0,r.jsx)("button",{onClick:()=>{var e,r;let l=n?i&~(1<<t):i|1<<t;c(l),null==(r=_.current)||null==(e=r.set_sequence_mask)||e.call(r,l)},className:["h-8 rounded-md border transition text-xs font-semibold relative",n?"bg-lime-400/80 text-black border-lime-300 shadow-[0_0_10px_#a3e63566]":"bg-[#0a0f1f]/60 text-cyan-200 border-white/10 hover:bg-[#0f1a2f]/60",s===t?"ring-2 ring-fuchsia-400/80 ring-offset-2 ring-offset-[#070a12]":""].join(" "),title:"Step ".concat(t+1),children:t+1},t)})})}),(0,r.jsx)("canvas",{ref:e,width:1024,height:256,className:"w-full rounded-xl bg-[#070a12] shadow-[0_0_24px_#00eaff44,0_0_48px_#ff00ff22] border border-white/10"})]})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=6221)),_N_E=e.O()}]);